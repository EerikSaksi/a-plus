{% extends "edit_course/edit_course_base.html" %}
{% load i18n %}
{% load course %}

{% block edittitle %}{% translate "LIST_DEADLINE_DEVIATIONS" %}{% endblock %}
{% block view_tag %}edit-course,deviations{% endblock %}

{% block editbreadcrumblist %}
{{ block.super }}
<li class="active">{% translate "LIST_DEADLINE_DEVIATIONS" %}</li>
{% endblock %}

{% block coursecontent %}
<br />
<p>
	<a class="aplus-button--default aplus-button--xs" role="button" href="{{ instance|url:'deviations-add-dl' }}">
		<span class="glyphicon glyphicon-time" aria-hidden="true"></span>
		{% translate "ADD_NEW_DEADLINE_DEVIATIONS" %}
	</a>
</p>
<div class="panel panel-primary">
	<div class="panel-heading">
		<h3 class="panel-title">{% translate "DEADLINE_DEVIATIONS" %}</h3>
	</div>
	<table class="table table-striped table-bordered table-condensed filtered-table ordered-table grouped-table">
		<thead>
			<tr>
				<th>{% translate "SUBMITTER" %}</th>
				<th>{% translate "EXERCISE" %}</th>
				<th>{% translate "EXTRA_MINUTES" %}</th>
				<th
					data-filter-type="options"
					data-filter-options="{% translate 'YES' %}|{% translate 'NO' %}"
					data-order-disable="true"
				>
					{% translate "WITHOUT_LATE_PENALTY" %}
				</th>
				<th>{% translate "GRANTER" %}</th>
				<th>{% translate "GRANT_TIME" %}</th>
				<th data-filter-type="none" data-order-disable="true">{% translate "ACTIONS" %}</th>
			</tr>
		</thead>
		<tbody>
			{% translate "UNKNOWN" as unknown %}
			{% for deviations, can_group, group_id in deviation_groups %}
			{% if can_group %}
			<tr data-group-parent="{{ group_id }}">
				<td>{{ deviations.0.submitter }}</td>
				<td>
					{{ deviations.0.exercise.course_module }}
					<strong>
						({% blocktranslate trimmed with count=deviations|length %}
						NUM_OF_EXERCISES -- {{ count }}
						{% endblocktranslate %})
					</strong>
				</td>
				<td>{{ deviations.0.extra_minutes }}</td>
				<td>
					{% if deviations.0.without_late_penalty %}
						<span class="glyphicon glyphicon-ok"></span>
						{% translate "YES" %}
					{% else %}
						<span class="glyphicon glyphicon-remove"></span>
						{% translate "NO" %}
					{% endif %}
				</td>
				<td></td>
				<td></td>
				<td></td>
			</tr>
			{% endif %}
			{% for deviation in deviations %}
			<tr {% if can_group %}data-group-child="{{ group_id }}" class="hidden-group info"{% endif %}>
				<td>{{ deviation.submitter }}</td>
				<td>{{ deviation.exercise }}</td>
				<td>{{ deviation.extra_minutes }}</td>
				<td>
					{% if deviation.without_late_penalty %}
						<span class="glyphicon glyphicon-ok"></span>
						{% translate "YES" %}
					{% else %}
						<span class="glyphicon glyphicon-remove"></span>
						{% translate "NO" %}
					{% endif %}
				</td>
				<td>
					{{ deviation.granter|default_if_none:unknown }}
				</td>
				<td data-datetime="{{ deviation.grant_time|date:'Y-m-d H:i:s' }}">
					{{ deviation.grant_time|default_if_none:unknown }}
				</td>
				<td>
					<form method="post" action="{{ deviation|url:'deviations-remove-dl' }}">
						{% csrf_token %}
						<button type="submit" class="aplus-button--danger aplus-button--xs">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
							{% translate "REMOVE" %}
						</button>
					</form>
				</td>
			</tr>
			{% endfor %}
			{% empty %}
			<tr>
				<td colspan="7">{% translate "NO_DEADLINE_DEVIATIONS" %}</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}
